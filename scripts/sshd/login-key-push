#!/usr/bin/env bash

set -e

if [ "${2}" = "" ] ;then
    host=${EASY_OP_SSH_HOST}
    keyfile=${1}
    shift
else
    host=${1}
    shift
    keyfile=${1}
    shift
fi

command -v ssh-copy-id > /dev/null 2>&1 || {
    echo    'ERROR: no ssh-copy-id found'
}
command -v ssh-copy-id > /dev/null 2>&1 && {
    ssh-copy-id -i "${keyfile}" -o PreferredAuthentications=password $@ ${host}
}
